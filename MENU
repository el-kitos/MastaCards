import pygame
import sys
import os

pygame.init()

# --- CONFIGURACIÓN ---
ANCHO, ALTO = 1152, 768
FPS = 60

# Colores
AMARILLO = (255, 255, 0)

# Opciones del menú (ya están pintadas en la imagen)
opciones = ["PLAY", "EXIT", "TUTORIAL"]
opcion_seleccionada = 0

# Coordenadas de las opciones en la imagen
posiciones = [
    (ANCHO // 2, 450),  # PLAY
    (ANCHO // 2, 550),  # EXIT
    (ANCHO // 2, 650)   # TUTORIAL
]

# ---------------- FUNCIONES ---------------- #

def cargar_recursos():
    """Carga la imagen de fondo desde la carpeta IMG"""
    ruta_fondo = os.path.join(os.path.dirname(__file__), "IMG", "MENUMASTA.png")
    fondo = pygame.image.load(ruta_fondo).convert()
    return fondo

def dibujar_menu(screen, fondo, opcion_seleccionada):
    """Dibuja el fondo y resalta la opción seleccionada"""
    screen.blit(fondo, (0, 0))

    for i, pos in enumerate(posiciones):
        if i == opcion_seleccionada:
            x, y = pos
            rect = pygame.Rect(0, 0, 400, 60)
            rect.center = (x, y)
            pygame.draw.rect(screen, AMARILLO, rect, 3)

    pygame.display.flip()

def manejar_eventos(opcion_seleccionada):
    """Procesa los eventos del teclado y devuelve la opción seleccionada"""
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            pygame.quit()
            sys.exit()

        if event.type == pygame.KEYDOWN:
            if event.key == pygame.K_UP:
                opcion_seleccionada = (opcion_seleccionada - 1) % len(opciones)
            elif event.key == pygame.K_DOWN:
                opcion_seleccionada = (opcion_seleccionada + 1) % len(opciones)
            elif event.key == pygame.K_RETURN:
                ejecutar_accion(opciones[opcion_seleccionada])

    return opcion_seleccionada

def ejecutar_accion(opcion):
    """Ejecuta la acción según la opción elegida"""
    if opcion == "EXIT":
        pygame.quit()
        sys.exit()
    elif opcion == "PLAY":
        print("Iniciando el juego...")
        # acá podrías llamar a otra función que empiece tu juego
    elif opcion == "TUTORIAL":
        print("Mostrando tutorial...")
        # acá podrías abrir el tutorial o mostrar instrucciones

def main():
    """Loop principal del menú"""
    global opcion_seleccionada
    screen = pygame.display.set_mode((ANCHO, ALTO))
    pygame.display.set_caption("Menu MA$TA")
    clock = pygame.time.Clock()

    fondo = cargar_recursos()

    while True:
        opcion_seleccionada = manejar_eventos(opcion_seleccionada)
        dibujar_menu(screen, fondo, opcion_seleccionada)
        clock.tick(FPS)


if __name__ == "__main__":
    main()
